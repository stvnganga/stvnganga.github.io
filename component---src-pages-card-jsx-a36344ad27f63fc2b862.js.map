{"version":3,"file":"component---src-pages-card-jsx-a36344ad27f63fc2b862.js","mappings":"6RAAO,IAAMA,EAAgB,gBAChBC,EAAmB,mBACnBC,EAAoB,oBACpBC,EAAiB,iBAE9B,Y,sGCIe,SAASC,IACtB,OAA0BC,EAAAA,EAAAA,UAAS,IAA5BC,EAAP,KAAcC,EAAd,KACA,GAAsCF,EAAAA,EAAAA,UAAS,CAAEG,KAAMF,IAAhDG,EAAP,KAAoBC,EAApB,KAEMC,EAAoB,SAACC,EAAMN,GAAP,OACxBI,GAAe,SAACG,GAAD,aAAUC,OAAOC,OAAO,CAAC,EAAGF,IAAlB,MAA2BD,GAAON,EAAlC,GAAV,GADS,EAwF1B,OA5CAU,EAAAA,EAAAA,YAAU,WACR,GAAIC,OAAQ,CACV,IAAMC,EAAU,IAAIC,iBAAiB,WACrCF,OAAOG,UAAY,SAACC,GACdA,EAAMR,KAAKS,cAAgBtB,EAAAA,eAC7BkB,EAAQK,YAAY,CAClBD,YAAarB,EAAAA,kBAGlB,EAEDiB,EAAQE,UAAY,SAACC,GACfA,EAAMR,KAAKS,cAAgBpB,EAAAA,mBAC7BS,EAAkBU,EAAMR,KAAKD,KAAMS,EAAMR,KAAKP,MAEjD,CACF,CACF,GAAE,KAEHU,EAAAA,EAAAA,YAAU,WACJP,EAAYe,KAAOf,EAAYgB,QAAUhB,EAAYD,OACvDkB,QAAQC,IAAI,eACY,SAApBlB,EAAYe,KACdI,EAAAA,EAAAA,SAAoB,CAClBC,KAAM,OACNP,YAAa,iBACbT,KAAM,CACJiB,QAAS,iBACTC,WAAY,QAIhBH,EAAAA,EAAAA,SAAoB,CAClBC,KAAM,OACNP,YAAa,iBACbT,KAAM,CACJiB,QAAS,eACTC,WAAY,OAKrB,IAGC,yBACEC,KAAK,OACLpB,KAAK,OACLqB,YAAY,kBACZ3B,MAAOA,EACP4B,SA3FiB,SAACC,GACpBT,QAAQC,IAAI,gBACZ,IAAQrB,EAAU6B,EAAOC,OAAjB9B,MAEJ,gBAAgB+B,KAAK/B,KACvBC,EAASD,GACTK,EAAkB,OAAQL,IAC1BsB,EAAAA,EAAAA,SAAoB,CAClBC,KAAM,OACNP,YAAa,aACbT,KAAM,CACJyB,MAAO,iBAAiBD,KAAK/B,MAIpC,EA6EGiC,QA3EgB,WAClBb,QAAQC,IAAI,iBACZC,EAAAA,EAAAA,SAAoB,CAClBC,KAAM,OACNP,YAAa,QACbT,KAAM,CACJ2B,UAAW,UACXlC,OAAO,IAGZ,EAkEGmC,OAhEe,WACjBf,QAAQC,IAAI,iBACZC,EAAAA,EAAAA,SAAoB,CAClBC,KAAM,OACNP,YAAa,QACbT,KAAM,CACJ2B,UAAW,SACXlC,OAAO,IAGZ,GAyDF,C,uBChHc,SAASsB,EAAoBE,GAC1C,YADwD,IAAdA,IAAAA,EAAU,CAAC,GAEjC,oBAAXb,QACPA,OAAOyB,OAAOnB,YACZO,EACA,IAAIa,gBAAgBC,SAASC,QAAQC,IAAI,UAG9C,C","sources":["webpack://input-fields/./src/pages/paymentActions.ts","webpack://input-fields/./src/pages/card.jsx","webpack://input-fields/./src/pages/postMessageToParent.js"],"sourcesContent":["export const START_PAYMENT = \"start-payment\";\nexport const GET_PAYMENT_DATA = \"GET_PAYMENT_DATA\";\nexport const SEND_PAYMENT_DATA = \"SEND_PAYMENT_DATA\";\nexport const PAYMENT_STATUS = \"payment-status\";\n\nexport default {};\n","import React, { useEffect, useRef, useState } from \"react\";\nimport postMessageToParent from \"./postMessageToParent\";\nimport {\n  GET_PAYMENT_DATA,\n  SEND_PAYMENT_DATA,\n  START_PAYMENT,\n} from \"./paymentActions\";\nimport \"./styles.css\";\n\nexport default function Card() {\n  const [value, setValue] = useState(\"\");\n  const [paymentData, setPaymentData] = useState({ card: value });\n\n  const updatePaymentData = (name, value) =>\n    setPaymentData((data) => Object.assign({}, data, { [name]: value }));\n\n  const handleChange = (change) => {\n    console.log(\"Card changed\");\n    const { value } = change.target;\n\n    if (/^[0-9]{0,19}$/.test(value)) {\n      setValue(value);\n      updatePaymentData(\"card\", value);\n      postMessageToParent({\n        from: \"card\",\n        messageType: \"validation\",\n        data: {\n          valid: /^[0-9]{13,19}$/.test(value),\n        },\n      });\n    }\n  };\n\n  const handleFocus = () => {\n    console.log(\"Card focused\");\n    postMessageToParent({\n      from: \"card\",\n      messageType: \"event\",\n      data: {\n        eventName: \"onfocus\",\n        value: true,\n      },\n    });\n  };\n\n  const handleBlur = () => {\n    console.log(\"Card blurred\");\n    postMessageToParent({\n      from: \"card\",\n      messageType: \"event\",\n      data: {\n        eventName: \"onblur\",\n        value: true,\n      },\n    });\n  };\n\n  useEffect(() => {\n    if (window) {\n      const channel = new BroadcastChannel(\"payment\");\n      window.onmessage = (event) => {\n        if (event.data.messageType === START_PAYMENT) {\n          channel.postMessage({\n            messageType: GET_PAYMENT_DATA,\n          });\n        }\n      };\n\n      channel.onmessage = (event) => {\n        if (event.data.messageType === SEND_PAYMENT_DATA) {\n          updatePaymentData(event.data.name, event.data.value);\n        }\n      };\n    }\n  }, []);\n\n  useEffect(() => {\n    if (paymentData.cvv && paymentData.expiry && paymentData.card) {\n      console.log(\"send status\")\n      if (paymentData.cvv === \"1111\") {\n        postMessageToParent({\n          from: \"card\",\n          messageType: \"payment-status\",\n          data: {\n            message: \"Payment failed\",\n            statusCode: 300,\n          },\n        });\n      } else {\n        postMessageToParent({\n          from: \"card\",\n          messageType: \"payment-status\",\n          data: {\n            message: \"Payment done\",\n            statusCode: 200,\n          },\n        });\n      }\n    }\n  });\n\n  return (\n    <input\n      type=\"text\"\n      name=\"card\"\n      placeholder=\"13 to 19 digits\"\n      value={value}\n      onChange={handleChange}\n      onFocus={handleFocus}\n      onBlur={handleBlur}\n    />\n  );\n}\n","export default function postMessageToParent(message = {}) {\n  return (\n    typeof window !== \"undefined\" &&\n    window.parent.postMessage(\n      message,\n      new URLSearchParams(location.search).get(\"origin\")\n    )\n  );\n}\n"],"names":["START_PAYMENT","GET_PAYMENT_DATA","SEND_PAYMENT_DATA","PAYMENT_STATUS","Card","useState","value","setValue","card","paymentData","setPaymentData","updatePaymentData","name","data","Object","assign","useEffect","window","channel","BroadcastChannel","onmessage","event","messageType","postMessage","cvv","expiry","console","log","postMessageToParent","from","message","statusCode","type","placeholder","onChange","change","target","test","valid","onFocus","eventName","onBlur","parent","URLSearchParams","location","search","get"],"sourceRoot":""}