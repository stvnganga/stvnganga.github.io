{"version":3,"file":"component---src-pages-card-jsx-cf3d32bdbbfbea8f6e40.js","mappings":"6RAAO,IAAMA,EAAgB,gBAChBC,EAAmB,mBACnBC,EAAoB,oBACpBC,EAAiB,iBAE9B,Y,sGCIe,SAASC,IACtB,OAA0BC,EAAAA,EAAAA,UAAS,IAA5BC,EAAP,KAAcC,EAAd,KACMC,GAAUC,EAAAA,EAAAA,QAAO,IAAIC,iBAAiB,YAC5C,GAAsCL,EAAAA,EAAAA,UAAS,CAAEM,KAAML,IAAhDM,EAAP,KAAoBC,EAApB,KA8EA,OApCAC,EAAAA,EAAAA,YAAU,WACJC,SACFA,OAAOC,UAAY,SAACC,GAClB,GAAKA,EAAMC,KAAKC,YAEhB,OAAQF,EAAMC,KAAKC,aACjB,KAAKnB,EAAAA,cACHQ,EAAQY,QAAQC,YAAY,CAC1BF,YAAalB,EAAAA,mBAEf,MACF,KAAKC,EAAAA,kBACCe,EAAMC,KAAKI,MAAQL,EAAMC,KAAKZ,OAChCO,GAAe,SAACK,GAAD,aACbK,OAAOC,OAAO,CAAC,EAAGN,IAAlB,MAA2BD,EAAMC,KAAKI,MAAOL,EAAMC,KAAKZ,MAAxD,GADa,IAItB,EAEJ,GAAE,KAEHQ,EAAAA,EAAAA,YAAU,WACJF,EAAYa,KAAOb,EAAYc,QAAUd,EAAYD,OACvDgB,QAAQC,IAAIhB,IACZiB,EAAAA,EAAAA,SAAoB,CAClBC,KAAM,gBACNX,YAAa,iBACbD,KAAM,CACJa,SAAU,IACVC,QAAS,GACTC,WAAY,OAInB,IAGC,yBACEC,KAAK,OACLZ,KAAK,OACLa,YAAY,kBACZ7B,MAAOA,EACP8B,SAlFiB,SAACC,GACpBV,QAAQC,IAAI,gBACZ,IAAQtB,EAAU+B,EAAOC,OAAjBhC,MAEJ,gBAAgBiC,KAAKjC,KACvBC,EAASD,IACTuB,EAAAA,EAAAA,SAAoB,CAClBC,KAAM,OACNX,YAAa,aACbD,KAAM,CACJsB,MAAO,iBAAiBD,KAAKjC,MAIpC,EAqEGmC,QAnEgB,WAClBd,QAAQC,IAAI,iBACZC,EAAAA,EAAAA,SAAoB,CAClBC,KAAM,OACNX,YAAa,QACbD,KAAM,CACJwB,UAAW,UACXpC,OAAO,IAGZ,EA0DGqC,OAxDe,WACjBhB,QAAQC,IAAI,iBACZC,EAAAA,EAAAA,SAAoB,CAClBC,KAAM,OACNX,YAAa,QACbD,KAAM,CACJwB,UAAW,SACXpC,OAAO,IAGZ,GAiDF,C,uBCrGc,SAASuB,EAAoBG,GAC1C,YADwD,IAAdA,IAAAA,EAAU,CAAC,GAEjC,oBAAXjB,QACPA,OAAO6B,OAAOvB,YACZwB,KAAKC,UAAUd,GACf,IAAIe,gBAAgBC,SAASC,QAAQC,IAAI,UAG9C,C","sources":["webpack://input-fields/./src/pages/paymentActions.ts","webpack://input-fields/./src/pages/card.jsx","webpack://input-fields/./src/pages/postMessageToParent.js"],"sourcesContent":["export const START_PAYMENT = \"start-payment\";\nexport const GET_PAYMENT_DATA = \"GET_PAYMENT_DATA\";\nexport const SEND_PAYMENT_DATA = \"SEND_PAYMENT_DATA\";\nexport const PAYMENT_STATUS = \"payment-status\";\n\nexport default {};\n","import React, { useEffect, useRef, useState } from \"react\";\nimport postMessageToParent from \"./postMessageToParent\";\nimport {\n  GET_PAYMENT_DATA,\n  SEND_PAYMENT_DATA,\n  START_PAYMENT,\n} from \"./paymentActions\";\nimport \"./styles.css\";\n\nexport default function Card() {\n  const [value, setValue] = useState(\"\");\n  const channel = useRef(new BroadcastChannel(\"payment\"));\n  const [paymentData, setPaymentData] = useState({ card: value });\n\n  const handleChange = (change) => {\n    console.log(\"Card changed\");\n    const { value } = change.target;\n\n    if (/^[0-9]{0,19}$/.test(value)) {\n      setValue(value);\n      postMessageToParent({\n        from: \"card\",\n        messageType: \"validation\",\n        data: {\n          valid: /^[0-9]{13,19}$/.test(value),\n        },\n      });\n    }\n  };\n\n  const handleFocus = () => {\n    console.log(\"Card focused\");\n    postMessageToParent({\n      from: \"card\",\n      messageType: \"event\",\n      data: {\n        eventName: \"onfocus\",\n        value: true,\n      },\n    });\n  };\n\n  const handleBlur = () => {\n    console.log(\"Card blurred\");\n    postMessageToParent({\n      from: \"card\",\n      messageType: \"event\",\n      data: {\n        eventName: \"onblur\",\n        value: true,\n      },\n    });\n  };\n\n  useEffect(() => {\n    if (window) {\n      window.onmessage = (event) => {\n        if (!event.data.messageType) return;\n\n        switch (event.data.messageType) {\n          case START_PAYMENT:\n            channel.current.postMessage({\n              messageType: GET_PAYMENT_DATA,\n            });\n            break;\n          case SEND_PAYMENT_DATA:\n            if (event.data.name && event.data.value)\n              setPaymentData((data) =>\n                Object.assign({}, data, { [event.data.name]: event.data.value })\n              );\n        }\n      };\n    }\n  }, []);\n\n  useEffect(() => {\n    if (paymentData.cvv && paymentData.expiry && paymentData.card) {\n      console.log(paymentData);\n      postMessageToParent({\n        from: \"hosted-frames\",\n        messageType: \"payment-status\",\n        data: {\n          complete: true / false,\n          message: \"\",\n          statusCode: 200,\n        },\n      });\n    }\n  });\n\n  return (\n    <input\n      type=\"text\"\n      name=\"card\"\n      placeholder=\"13 to 19 digits\"\n      value={value}\n      onChange={handleChange}\n      onFocus={handleFocus}\n      onBlur={handleBlur}\n    />\n  );\n}\n","export default function postMessageToParent(message = {}) {\n  return (\n    typeof window !== \"undefined\" &&\n    window.parent.postMessage(\n      JSON.stringify(message),\n      new URLSearchParams(location.search).get(\"origin\")\n    )\n  );\n}\n"],"names":["START_PAYMENT","GET_PAYMENT_DATA","SEND_PAYMENT_DATA","PAYMENT_STATUS","Card","useState","value","setValue","channel","useRef","BroadcastChannel","card","paymentData","setPaymentData","useEffect","window","onmessage","event","data","messageType","current","postMessage","name","Object","assign","cvv","expiry","console","log","postMessageToParent","from","complete","message","statusCode","type","placeholder","onChange","change","target","test","valid","onFocus","eventName","onBlur","parent","JSON","stringify","URLSearchParams","location","search","get"],"sourceRoot":""}